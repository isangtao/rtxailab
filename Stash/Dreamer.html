<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dreamer</title>
    <style>
        /* Basic Reset & Body Styling */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            background-color: black; /* Dark background overall */
            color: green; /* Light text color */
            display: flex; /* Use flexbox for layout */
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Main Container */
        .container {
            display: flex;
            width: 100%;
        }

        /* Sidebar Styling */
        .sidebar {
            width: 350px; /* Fixed width for the sidebar */
            background-color: black; /* Slightly different dark shade */
            padding: 20px;
            border-right: 1px solid green;
            overflow-y: auto; /* Allow scrolling if content overflows */
            height: 100vh; /* Make sidebar full height */
        }

        .sidebar h2 {
            color: green;
            margin-bottom: 5px;
            font-size: 1.5em;
        }

        .sidebar .subtitle {
            font-size: 0.8em;
            color: green;
            margin-bottom: 25px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            font-size: 0.9em;
            color: green;
            margin-bottom: 5px;
        }

        .form-group input[type="text"],
        .form-group input[type="number"],
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 8px 10px;
            background-color: black;
            border: 1px solid green;
            color: green;
            border-radius: 4px;
            font-size: 0.95em;
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-group select {
            appearance: none; /* Basic styling for select */
            background-repeat: no-repeat;
            background-position: right 10px top 50%;
            background-size: .65em auto;
        }

        /* Main Content Area Styling */
        .main-content {
            flex: 1; /* Takes remaining width */
            padding: 25px 40px;
            background-color: black; /* Slightly different dark shade */
            overflow-y: auto; /* Allow scrolling for story */
            height: 100vh;
        }

        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid green;
        }

        .top-bar button {
            padding: 8px 18px;
            background-color: black;
            border: 1px solid green;
            color: green;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
        }
         .top-bar button:hover {
             background-color: black;
         }

        .top-bar .prompt-info {
            font-size: 0.9em;
            color: green;
            /* In a real app, this might be a dropdown/collapsible section */
        }


        .story-content h1 {
            font-size: 1.8em;
            color: green;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .story-content p {
            margin-bottom: 1.2em;
            color: green; /* Slightly lighter text for readability */
        }

        .footer-instructions {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid green;
            font-size: 0.85em;
            color: green;
        }
        .footer-instructions a {
            color: green;
            text-decoration: none;
        }
        .footer-instructions a:hover {
            text-decoration: underline;
        }

    </style>
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <h2>Dreamer</h2>
            <p class="subtitle">Â© 2025 Michael Carlos</p>

            <div class="form-group">
                <label for="apikey">OpenRouter API Key</label>
                <input type="text" id="apikey" value="">
            </div>            
            
            <div class="form-group">
                <label for="model">Model</label>
                <input type="text" id="model" value="google/gemma-3-27b-it:free">
            </div>

            <div class="form-group">
                <label for="protagonistname">Protagonist's name</label>
                <input type="text" id="protagonistname" value="Michael Carlos">
            </div>

            <div class="form-group">
                <label for="ethnicity">Ethnicity</label>
                <input type="text" id="ethnicity" value="Filipino">
            </div>

            <div class="form-group">
                <label for="gender">Gender</label>
                <input type="text" id="gender" value="Male">
            </div>

            <div class="form-group">
                <label for="age">Age</label>
                <input type="number" id="age" value="55">
            </div>

            <div class="form-group">
                <label for="height">Height</label>
                <input type="text" id="height" value="5ft 10in">
            </div>

            <div class="form-group">
                <label for="interests">Interests</label>
                <input type="text" id="interests" value="robotics, motorcycling, aikido, archery, hiking, kayaking, snorkeling">
            </div>

            <div class="form-group">
                <label for="occupation">Occupation</label>
                <input type="text" id="occupation" value="AI Researcher and Developer">
            </div>

            <div class="form-group">
                <label for="country">Country of residence</label>
                <input type="text" id="country" value="Canada">
            </div>

            <div class="form-group">
                <label for="city">City of residence</label>
                <input type="text" id="city" value="Vancouver">
            </div>

             <div class="form-group">
                <label for="other">Other</label>
                <input type="text" id="other" value="Founded AGI Labs Inc, a company focused on Artificial General Intelligence. He developed a real-time, reinforcement-learning architecture that self-organizes through evolutionary algorithms.">
            </div>

            <div class="form-group">
                <label for="additional">Additional Instructions</label>
                <textarea id="additional">Do not say static, bloom, rain, algorithm, echo or echoes. Give the story a happy ending. Set it in a utopian downtown Vancouver in the near future with sunshine and warm weather. Depict Robots as decent, helpful and protective. Do not address Michael Carlos as Dr. or Mike.</textarea>
            </div>

            <div class="form-group">
                <label for="style">Style</label>
                <select id="style">
                    <option selected>Adult novel</option>
                    <option>Teen adventure</option>
                    <option>Childrens' book</option>
                    <!-- Add other options if known -->
                </select>
            </div>

             <div class="form-group">
                <label for="type">Type</label>
                <select id="type">
                    <option selected>Science fiction</option>
                    <option>Suspense</option>
                    <option>Thriller</option>
                    <option>Action</option>
                    <option>Adventure</option>
                    <option>Fantasy</option>
                    <option>Horror</option>
                    <option>Mystery</option>
                </select>
            </div>

            <div class="form-group">
                <button onclick="GeneratePlot()">New Plot</button>
                <label for="plot">Plot</label>
                <textarea id="plot">(Click 'New Plot' or provide your own.)</textarea>
            </div>

        </div>

        <div class="main-content">
            <div class="top-bar">
                <button onclick="GenerateStory()">Generate</button>
            </div>
            <pre id="responseOutput" style="white-space: pre-wrap; word-break: keep-all;"></pre>

            <div class="footer-instructions">
                <p>Using the attached photo(s) of the protagonist, generate 10 images that show the important moments of the story above. Do not include text. Do not depict children. If you can't generate an image, skip that part of the story and generate the next image. https://copilot.microsoft.com/ https://aistudio.google.com/</a></p>
                 <p style="text-align: right; color: #666; font-size: 0.8em; margin-top:10px;">1080 x 1885</p>
            </div>
        </div>
    </div>

    <script>

        async function GeneratePlot() 
        {
            const protagonistname = document.getElementById("protagonistname").value;
            const ethnicity = document.getElementById("ethnicity").value;
            const gender = document.getElementById("gender").value;
            const age = document.getElementById("age").value;
            const height = document.getElementById("height").value;
            const interests = document.getElementById("interests").value;
            const occupation = document.getElementById("occupation").value;
            const country = document.getElementById("country").value;
            const city = document.getElementById("city").value;
            const other = document.getElementById("other").value;
            const additional = document.getElementById("additional").value;
            const stylee = document.getElementById("style");
            var style = stylee.options[stylee.selectedIndex].text;
            const typee = document.getElementById("type");
            var type = typee.options[typee.selectedIndex].text;
            const plot = document.getElementById("plot").value;

            context = "\nDetails about the protagonist of a story follows.\nName: " + protagonistname + "\nEthnicity: " + ethnicity + "\nGender: " + gender + "\nAge: " + age + "\nHeight: " + height + "\nInterests: " + interests + "\nOccupation: " + occupation + "\nCountry of residence: " + country + "\nCity of residence: " + city + "\nOther: " + other;

            const apikey = document.getElementById("apikey").value;
            const model = document.getElementById("model").value;

            myprompt = context + "\n\nProvide an unusual " + type + " plot based on the information above. " + additional + " Don't explain or preamble. Just state the plot summary in one sentence."

            document.getElementById("plot").value = "Updating...";
            console.log(myprompt);

            const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": `Bearer ${apikey}`
                },
                body: JSON.stringify({
                    model: model,
                    messages: [{ role: "user", content: myprompt }]
                })
            });

            const data = await response.json();
            document.getElementById("plot").value = data.choices?.[0]?.message?.content || "Error: No response";
        }

        async function GenerateStory() 
        {

            const protagonistname = document.getElementById("protagonistname").value;
            const ethnicity = document.getElementById("ethnicity").value;
            const gender = document.getElementById("gender").value;
            const age = document.getElementById("age").value;
            const height = document.getElementById("height").value;
            const interests = document.getElementById("interests").value;
            const occupation = document.getElementById("occupation").value;
            const country = document.getElementById("country").value;
            const city = document.getElementById("city").value;
            const other = document.getElementById("other").value;
            const additional = document.getElementById("additional").value;
            const stylee = document.getElementById("style");
            var style = stylee.options[stylee.selectedIndex].text;
            const typee = document.getElementById("type");
            var type = typee.options[typee.selectedIndex].text;
            const plot = document.getElementById("plot").value;

            context = "\nDetails about the protagonist of a story follows.\nName: " + protagonistname + "\nEthnicity: " + ethnicity + "\nGender: " + gender + "\nAge: " + age + "\nHeight: " + height + "\nInterests: " + interests + "\nOccupation: " + occupation + "\nCountry of residence: " + country + "\nCity of residence: " + city + "\nOther: " + other + "\nPlot: " + plot;

            myprompt = context + "\n\nIn the style of a " + type + " " + style + ", write a long story based on the plot. " + additional + " Do not use markdown. Provide no explanation or preamble. Just state the title and jump into the story.\n\n";
            
            const outputElement = document.getElementById("responseOutput");
            outputElement.textContent = "";
            console.log(myprompt);

            const apikey = document.getElementById("apikey").value;
            const model = document.getElementById("model").value;

            const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": `Bearer ${apikey}`
                },
                body: JSON.stringify({
                    model: model,
                    messages: [{ role: "user", content: myprompt }],
                    stream: true
                })
            });

            const reader = response.body.getReader();
            const decoder = new TextDecoder();

            while (true) {
                const { done, value } = await reader.read();
                if (done) break;

                const chunk = decoder.decode(value, { stream: true });
                chunk.split("\n").forEach(line => {
                    if (line.startsWith("data:")) {
                        try {
                            const json = JSON.parse(line.substring(5));
                            if (json.choices?.[0]?.delta?.content) {
                                outputElement.textContent += json.choices[0].delta.content;
                            }
                        } catch (error) {
                            console.error("Error parsing chunk:", error);
                        }
                    }
                });
            }
        }
    </script>
</body>
</html>
